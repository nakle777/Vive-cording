<!doctype html><html lang="ko"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><title>바이브코딩 참가자 조회 (디버그)</title><style>body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,"Apple SD Gothic Neo","Noto Sans KR","Malgun Gothic",sans-serif;line-height:1.5;margin:0;padding:0;background:#f7f7fb}.wrap{max-width:720px;margin:6vh auto;background:#fff;border-radius:16px;padding:24px;box-shadow:0 8px 30px rgba(0,0,0,.06)}h1{font-size:20px;margin:0 0 12px}label{display:block;font-size:14px;margin:12px 0 4px;color:#444}input{width:100%;padding:12px 14px;font-size:16px;border:1px solid #e2e2ea;border-radius:10px;outline:none}button{margin-top:16px;padding:10px 14px;border:0;border-radius:10px;background:#111827;color:#fff;cursor:pointer}.row{display:flex;gap:10px;align-items:center}.msg{margin-top:12px;font-size:14px}.ok{color:#065f46;background:#ecfdf5;padding:10px;border-radius:10px}.warn{color:#7c2d12;background:#fff7ed;padding:10px;border-radius:10px}pre{background:#0b1020;color:#d1d5db;padding:12px;border-radius:10px;overflow:auto;font-size:12px}code{color:#93c5fd}table{width:100%;border-collapse:collapse;margin-top:10px}th,td{border:1px solid #e5e7eb;padding:6px 8px;font-size:12px}th{background:#f3f4f6}</style></head><body><div class="wrap"><h1>바이브코딩 참가자 조회 (디버그)</h1><div class="row"><div style="flex:1"><label>참가자 이름</label><input id="pname" placeholder="예: 홍길동"></div><div style="flex:1"><label>보호자 성함</label><input id="gname" placeholder="예: 김OO"></div><div><button id="go">조회</button></div></div><div id="msg" class="msg"></div><h3>CSV 로딩 상태</h3><div id="status" class="msg"></div><div id="preview"></div><h3>콘솔 로그</h3><pre id="log"></pre></div><script>function log(s){const e=document.getElementById('log');e.textContent+=(typeof s==='string'?s:JSON.stringify(s))+"\n"}async function loadMapping(){const u='mapping.csv?'+Date.now();log('fetch: '+u);const r=await fetch(u);log('status: '+r.status);if(!r.ok)throw new Error('CSV 응답 오류: '+r.status);const t=await r.text();log('length: '+t.length);return parseCSV(t)}function parseCSV(t){t=t.replace(/^\uFEFF/,'');const e=t.split(/\r?\n/).filter(Boolean);const h=e.shift().split(',').map(h=>h.trim());const n=h.indexOf('참가자 이름'),p=h.indexOf('보호자 성함'),l=h.indexOf('link');if(n<0||p<0||l<0){throw new Error('헤더 확인 필요 (참가자 이름, 보호자 성함, link) → 현재: '+h.join(' | '))}const rows=e.map(line=>{const a=line.split(',').map(x=>x.trim());return{pname:a[n]||'',gname:a[p]||'',link:a[l]||''}});return rows}function normalize(k){return(k||'').replace(/\s+/g,'').toLowerCase()}function renderPreview(rows){const n=rows.length;document.getElementById('status').innerHTML='행 개수: <b>'+n+'</b>';const head=rows.slice(0,5);const tbl=['<table><thead><tr><th>#</th><th>참가자 이름</th><th>보호자 성함</th><th>link</th></tr></thead><tbody>'];head.forEach((r,i)=>tbl.push('<tr><td>'+(i+1)+'</td><td>'+r.pname+'</td><td>'+r.gname+'</td><td>'+r.link+'</td></tr>'));tbl.push('</tbody></table>');document.getElementById('preview').innerHTML=tbl.join('')}let CACHE=null;window.addEventListener('load',async()=>{try{const rows=await loadMapping();CACHE=rows;renderPreview(rows);log('CSV 파싱 성공')}catch(e){document.getElementById('status').innerHTML='<div class="warn">'+e.message+'</div>';log('에러: '+e.message)}});document.getElementById('go').addEventListener('click',()=>{const pname=document.getElementById('pname').value;const gname=document.getElementById('gname').value;const msg=document.getElementById('msg');if(!CACHE){msg.className='msg warn';msg.textContent='CSV 미로딩';return}const key=normalize(pname)+'|'+normalize(gname);const match=CACHE.find(r=>(normalize(r.pname)+'|'+normalize(r.gname))===key);if(!match){msg.className='msg warn';msg.textContent='일치 항목 없음';return}if(!match.link){msg.className='msg warn';msg.textContent='link 값 비어 있음';return}msg.className='msg ok';msg.textContent='이동: '+match.link})</script></body></html>